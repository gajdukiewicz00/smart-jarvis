# üé§ Speech Service TTS - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

## ‚úÖ –°—Ç–∞—Ç—É—Å: –ü–û–õ–ù–û–°–¢–¨–Æ –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–û

TTS (Text-to-Speech) —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≤ Speech Service –±—ã–ª–∞ —É—Å–ø–µ—à–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞.

## üîß –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. **–ó–∞–º–µ–Ω–∞ espeak –Ω–∞ gTTS**
- **–ü—Ä–æ–±–ª–µ–º–∞**: espeak –Ω–µ —Ä–∞–±–æ—Ç–∞–ª –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
- **–†–µ—à–µ–Ω–∏–µ**: –ó–∞–º–µ–Ω–∏–ª–∏ –Ω–∞ Google Text-to-Speech (gTTS)
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: 
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —è–∑—ã–∫–æ–≤
  - –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ —Ä–µ—á–∏
  - –ù–∞–¥–µ–∂–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤ Docker

### 2. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**
```python
# –î–æ–±–∞–≤–ª–µ–Ω–æ –≤ requirements.txt
gTTS==2.4.0
```

### 3. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Dockerfile**
```dockerfile
# –î–æ–±–∞–≤–ª–µ–Ω—ã –∞—É–¥–∏–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pulseaudio \
pulseaudio-utils \
alsa-utils \
```

### 4. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞**
- –ó–∞–º–µ–Ω–∏–ª–∏ `pyttsx3` –Ω–∞ `gTTS`
- –î–æ–±–∞–≤–∏–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —è–∑—ã–∫–æ–≤
- –£–ª—É—á—à–∏–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫

## üåç –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —è–∑—ã–∫–∏

| –ö–æ–¥ | –Ø–∑—ã–∫ | –°—Ç–∞—Ç—É—Å |
|-----|-------|--------|
| `en` | English | ‚úÖ |
| `ru` | Russian | ‚úÖ |
| `es` | Spanish | ‚úÖ |
| `fr` | French | ‚úÖ |
| `de` | German | ‚úÖ |
| `it` | Italian | ‚úÖ |
| `pt` | Portuguese | ‚úÖ |
| `ja` | Japanese | ‚úÖ |
| `ko` | Korean | ‚úÖ |
| `zh` | Chinese | ‚úÖ |

## üì° API Endpoints

### 1. **Text-to-Speech**
```http
POST /api/text-to-speech
Content-Type: application/json

{
  "text": "Hello, world!",
  "voice": "en"
}
```

**–û—Ç–≤–µ—Ç**: MP3 –∞—É–¥–∏–æ —Ñ–∞–π–ª

### 2. **Available Voices**
```http
GET /api/voices
```

**–û—Ç–≤–µ—Ç**:
```json
{
  "voices": {
    "en": "English",
    "ru": "Russian",
    "es": "Spanish",
    ...
  },
  "default": "en",
  "message": "gTTS supports multiple languages"
}
```

### 3. **Health Check**
```http
GET /health
```

**–û—Ç–≤–µ—Ç**:
```json
{
  "status": "healthy",
  "service": "speech-service",
  "timestamp": "1234567890.123",
  "nlp_engine_url": "http://nlp-engine:8082"
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç TTS
```bash
python3 test_tts.py
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç
```bash
python3 test_integration.py
```

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ curl
```bash
# –ü—Ä—è–º–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ Speech Service
curl -X POST http://localhost:8083/api/text-to-speech \
  -H "Content-Type: application/json" \
  -d '{"text": "Hello, world!", "voice": "en"}' \
  --output test.mp3

# –ß–µ—Ä–µ–∑ API Gateway
curl -X POST http://localhost:8080/speech-service/api/text-to-speech \
  -H "Content-Type: application/json" \
  -d '{"text": "Hello, world!", "voice": "en"}' \
  --output test_gateway.mp3
```

## üê≥ Docker

### –°–±–æ—Ä–∫–∞
```bash
cd docker
sudo docker compose build speech-service
```

### –ó–∞–ø—É—Å–∫
```bash
sudo docker compose up -d speech-service
```

### –õ–æ–≥–∏
```bash
sudo docker compose logs speech-service
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã

1. **Health Check**: ‚úÖ
2. **Voices Endpoint**: ‚úÖ (10 —è–∑—ã–∫–æ–≤)
3. **TTS Endpoint**: ‚úÖ (–≤—Å–µ —è–∑—ã–∫–∏)
4. **NLP Integration**: ‚úÖ
5. **API Gateway**: ‚úÖ
6. **Task Service Integration**: ‚úÖ

### üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- `test_tts_en.mp3` (25KB) - –∞–Ω–≥–ª–∏–π—Å–∫–∏–π
- `test_tts_ru.mp3` (25KB) - —Ä—É—Å—Å–∫–∏–π  
- `test_tts_es.mp3` (26KB) - –∏—Å–ø–∞–Ω—Å–∫–∏–π
- `test_tts_gateway.mp3` (40KB) - —á–µ—Ä–µ–∑ API Gateway

## üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏

### NLP Engine
- Speech Service –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≥–æ–ª–æ—Å–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å NLP Engine –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –Ω–∞–º–µ—Ä–µ–Ω–∏–π
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á —á–µ—Ä–µ–∑ –≥–æ–ª–æ—Å–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã

### Task Service
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á —á–µ—Ä–µ–∑ –≥–æ–ª–æ—Å–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã
- –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª: –ì–æ–ª–æ—Å ‚Üí –¢–µ–∫—Å—Ç ‚Üí NLP ‚Üí –î–µ–π—Å—Ç–≤–∏–µ ‚Üí –û—Ç–≤–µ—Ç

### API Gateway
- –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ nginx
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –ü—Ä–æ—Å—Ç–æ–µ TTS
```python
import requests

response = requests.post(
    "http://localhost:8083/api/text-to-speech",
    json={"text": "Hello, world!", "voice": "en"}
)

with open("output.mp3", "wb") as f:
    f.write(response.content)
```

### 2. –ì–æ–ª–æ—Å–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã
```python
# –ó–∞–≥—Ä—É–∑–∫–∞ –∞—É–¥–∏–æ —Ñ–∞–π–ª–∞
with open("voice_command.wav", "rb") as f:
    files = {"audio_file": f}
    response = requests.post(
        "http://localhost:8083/api/voice-command",
        files=files
    )
    
result = response.json()
print(f"Recognized: {result['original_text']}")
print(f"Response: {result['tts_response']}")
```

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: –°–æ–∑–¥–∞—Ç—å UI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è TTS
2. **–†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è**: –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
3. **–ö–∞—á–µ—Å—Ç–≤–æ**: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–µ—á–∏ (—Å–∫–æ—Ä–æ—Å—Ç—å, —Ç–æ–Ω)
4. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ—Ä–∞–∑—ã
5. **–û—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º**: –õ–æ–∫–∞–ª—å–Ω—ã–π TTS –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

TTS —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –º–Ω–æ–∂–µ—Å—Ç–≤–æ —è–∑—ã–∫–æ–≤, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏ –∏ –ø–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ. –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ. 